function replaceSubstring(a,b,c,d){return a.substring(0,b)+d+a.substring(c,a.length)}function makeCypherEvalString(a){for(var b;-1!=(b=a.indexOf("."))&&b<a.indexOf("(");)a=replaceSubstring(a,b,b+1,"_");return a}function addTag(a,b,c){var d=document.createElement(b);document.getElementById(c).appendChild(d),d.setAttribute("id",a),"canvas"==b&&(canvasContexts[a]=d.getContext("2d"))}function getTagAttribute(a,b){return"value"==b?document.getElementById(a).value:document.getElementById(a).getAttribute(b)}function setTagAttribute(a,b,c){"value"==b?document.getElementById(a).value=c:document.getElementById(a).setAttribute(b,c)}function getTagChildren(a){for(var b=document.getElementById(a).childNodes,c=[],d=0;d<b.length;)c[d]=b[d].id,d+=1;return c}function getArrayKeys(a){var b=[];for(key in a)b[b.length]=key;return b}function objectIsInClass(a,b){for(var c=a[0],d=c;d!=b;)if(d=classParents[d],void 0==d)return!1;return!0}function getPrivateVariable(inputObject,inputVariableName){var objectClass=inputObject[0];return eval("get_"+objectClass+"_"+inputVariableName+"(inputObject)")}function drawCanvasPolygon(a,b){var c=canvasContexts[a];c.beginPath(),c.moveTo(b[0],b[1]);for(var d=2;d<b.length;)c.lineTo(b[d],b[d+1]),d+=2;c.closePath(),c.fill()}function new_color(a,b,c){return 16*a+4*b+c}function get_color_red(a){return parseInt(a/16)}function get_color_green(a){return parseInt(a%16/4)}function get_color_blue(a){return parseInt(a%4)}function set_inventory_item_color(a,b){a[1]=b}function get_inventory_item_color(a){return a[1]}function set_inventory_item_amount(a,b){a[2]=b}function get_inventory_item_amount(a){return a[2]}function new_inventory_item(a,b){return["inventory_item",a,b]}function add_inventory_item(a){var b=inventory_items.length;inventory_items[b]=a,0==b&&(selected_inventory_item_color=get_inventory_item_color(a))}function get_inventory_item_by_color(a){for(var b=0;b<inventory_items.length;){var c=inventory_items[b];if(b+=1,get_inventory_item_color(c)==a)return c}return!1}function display_inventory_items(){for(var a=0;inventory_div_amount>a;){document.getElementById("inventory.div."+a).style.border="3px white solid";var b=inventory_items[a+inventory_list_position];if(void 0!=b){var c=get_inventory_item_color(b),d=80*get_color_red(c),e=80*get_color_green(c),f=80*get_color_blue(c),g=get_inventory_item_amount(b);document.getElementById("inventory.div."+a).innerHTML="block "+c+": x"+g,document.getElementById("inventory.square."+a).style.background="rgb("+d+","+e+","+f+")",c==selected_inventory_item_color&&(document.getElementById("inventory.div."+a).style.border="3px black solid")}else document.getElementById("inventory.div."+a).innerHTML=" ",document.getElementById("inventory.square."+a).style.background="white";a+=1}}function select_inventory_item(a){var b=parseInt(a)+inventory_list_position,c=inventory_items[b];void 0!=c&&(selected_inventory_item_color=get_inventory_item_color(c),display_inventory_items())}function scroll_inventory_list(a){var b=inventory_list_position+parseInt(a);return 0>b|b>inventory_items.length-1?!1:(inventory_list_position=b,void display_inventory_items())}function offset_inventory_item_by_color(a,b){var c=get_inventory_item_by_color(a);if(0==c)return b>0?(c=new_inventory_item(a,b),add_inventory_item(c),display_inventory_items(),!0):!1;var d=get_inventory_item_amount(c);return d+=b,d>-1?(set_inventory_item_amount(c,d),display_inventory_items(),!0):!1}function set_point_x(a,b){a[1]=b}function get_point_x(a){return a[1]}function set_point_y(a,b){a[2]=b}function get_point_y(a){return a[2]}function new_point(a,b){return["point",a,b]}function draw_square(a,b,c){var d=get_point_x(a),e=get_point_y(a),f=0;0==c&&(f=64),canvasContexts.canvas.fillStyle="rgb("+f+", "+f+", "+f+")",canvasContexts.canvas.fillRect(d,e,b,b),d+=1,e+=1,b+=-2;var g=85*get_color_red(c),h=85*get_color_green(c),i=85*get_color_blue(c);canvasContexts.canvas.fillStyle="rgb("+g+", "+h+", "+i+")",canvasContexts.canvas.fillRect(d,e,b,b)}function draw_polygon(a,b,c){var d=c+85*get_color_red(b),e=c+85*get_color_green(b),f=c+85*get_color_blue(b);canvasContexts.canvas.fillStyle="rgb("+d+", "+e+", "+f+")",drawCanvasPolygon("canvas",a)}function draw_cube_face(a,b,c,d,e,f){if(0==a)var g=[get_point_x(d),get_point_y(d),get_point_x(d)+e,get_point_y(d),get_point_x(b)+c,get_point_y(b),get_point_x(b),get_point_y(b)],h=20;if(1==a)var g=[get_point_x(d)+e,get_point_y(d),get_point_x(d)+e,get_point_y(d)+e,get_point_x(b)+c,get_point_y(b)+c,get_point_x(b)+c,get_point_y(b)],h=-20;if(2==a)var g=[get_point_x(d),get_point_y(d)+e,get_point_x(d)+e,get_point_y(d)+e,get_point_x(b)+c,get_point_y(b)+c,get_point_x(b),get_point_y(b)+c],h=-60;if(3==a)var g=[get_point_x(d),get_point_y(d),get_point_x(d),get_point_y(d)+e,get_point_x(b),get_point_y(b)+c,get_point_x(b),get_point_y(b)],h=-20;draw_polygon(g,f,h)}function draw_cube_polygons(a,b,c,d,e){get_point_y(c)<get_point_y(a)&&draw_cube_face(0,a,b,c,d,e),get_point_x(c)+d>get_point_x(a)+b&&draw_cube_face(1,a,b,c,d,e),get_point_y(c)+d>get_point_y(a)+b&&draw_cube_face(2,a,b,c,d,e),get_point_x(c)<get_point_x(a)&&draw_cube_face(3,a,b,c,d,e)}function draw_person(a,b){var c=get_point_x(a),d=get_point_y(a);canvasContexts.canvas.fillStyle="rgb(0, 0, 0)",canvasContexts.canvas.fillRect(c+2*b/5,d,b/5,b/5),canvasContexts.canvas.strokeStyle="rgb(0, 0, 0)";var e=c+b/2,f=d+3*b/5,g=d+b/3,h=canvasContexts.canvas;h.beginPath(),h.moveTo(e,d+b/5),h.lineTo(e,f),h.stroke();var h=canvasContexts.canvas;h.beginPath(),h.moveTo(c+b/5,g),h.lineTo(c+4*b/5,g),h.stroke();var h=canvasContexts.canvas;h.beginPath(),h.moveTo(e,f),h.lineTo(c+b/3,d+b),h.stroke();var h=canvasContexts.canvas;h.beginPath(),h.moveTo(e,f),h.lineTo(c+2*b/3,d+b),h.stroke()}function draw_player(){var a=2*square_size/3,b=canvas_width/2-a/2,c=canvas_height/2,d=new_point(b,c);draw_person(d,a)}function set_pos_x(a,b){a[1]=b}function get_pos_x(a){return a[1]}function set_pos_y(a,b){a[2]=b}function get_pos_y(a){return a[2]}function set_pos_z(a,b){a[3]=b}function get_pos_z(a){return a[3]}function new_pos(a,b,c){return["pos",a,b,c]}function add_pos(a,b){set_pos_x(a,get_pos_x(a)+get_pos_x(b)),set_pos_y(a,get_pos_y(a)+get_pos_y(b)),set_pos_z(a,get_pos_z(a)+get_pos_z(b))}function multiply_pos(a,b){set_pos_x(a,get_pos_x(a)*b),set_pos_y(a,get_pos_y(a)*b),set_pos_z(a,get_pos_z(a)*b)}function pos_is_equal(a,b){return get_pos_x(a)==get_pos_x(b)&&get_pos_y(a)==get_pos_y(b)&&get_pos_z(a)==get_pos_z(b)}function set_layer_composition_pos_z(a,b){a[1]=b}function get_layer_composition_pos_z(a){return a[1]}function set_layer_composition_size(a,b){a[2]=b}function get_layer_composition_size(a){return a[2]}function set_layer_composition_colors(a,b){a[3]=b}function get_layer_composition_colors(a){return a[3]}function new_layer_composition(a,b,c){return["layer_composition",a,b,c]}function empty_layer_composition(a,b){return new_layer_composition(a,b,[])}function add_layer_composition_color(a,b,c){var d=get_layer_composition_colors(a),e=[];e[0]=b,e[1]=c;var f=d.length;d[f]=e}function pos_is_in_layer_composition(a,b){var c=get_pos_z(b),d=get_layer_composition_pos_z(a),e=get_layer_composition_size(a);return!(d>c)&&d+e>c?!0:!1}function add_layer_composition(a){var b=layer_compositions.length;layer_compositions[b]=a}function get_layer_composition_at_pos(a){if(0==layer_compositions.length)return!1;for(var b=0,c=!1;0==c&&b<layer_compositions.length;){var d=layer_compositions[b];pos_is_in_layer_composition(d,a)&&(c=d),b+=1}return c}function generate_layer_composition(a){for(var b=get_pos_z(a),c=1,d=4+parseInt(20*Math.random());d>0;)0==get_layer_composition_at_pos(new_pos(0,0,b-1))?(b-=1,c+=1,d-=1):d=0;for(var d=4+parseInt(Math.random()*(24-c));d>0;)0==get_layer_composition_at_pos(new_pos(0,0,b+c))?(c+=1,d-=1):d=0;for(var e=empty_layer_composition(b,c),d=2+parseInt(5*Math.random());d>0;){var f=parseInt(63*Math.random());parseInt(100*Math.random())>75&&(f=-1);var g=30+parseInt(70*Math.random());add_layer_composition_color(e,f,g),d-=1}return add_layer_composition(e),e}function get_random_layer_composition_color(a){for(var b=get_layer_composition_colors(a),c=0;c<b.length;){var d=b[c],e=d[0],f=d[1];if(parseInt(100*Math.random())>f|c==b.length-1)return e;c+=1}return-1}function get_random_layer_composition_color_at_pos(a){var b=get_layer_composition_at_pos(a);0==b&&(b=generate_layer_composition(a));var c=get_random_layer_composition_color(b);return c}function set_world_cell(a,b){world_cells[get_pos_z(a)][get_pos_y(a)][get_pos_x(a)]=b}function set_undefined_world_cell(a,b){var c=get_pos_z(a),d=get_pos_y(a),f=(get_pos_z(a),world_cells[c]);void 0==f?(world_cells[c]=[],world_cells[c][d]=[]):(f=f[d],void 0==f&&(world_cells[c][d]=[])),set_world_cell(a,b)}function get_world_cell(a){var b=world_cells[get_pos_z(a)];return void 0==b?undefined_color:(b=b[get_pos_y(a)],void 0==b?undefined_color:(b=b[get_pos_x(a)],void 0==b?undefined_color:b))}function get_random_neighbor_cell(a){for(var b=0;10>b;){var c=new_pos(1-parseInt(3*Math.random()),1-parseInt(3*Math.random()),1-parseInt(3*Math.random()));if(!pos_is_equal(c,new_pos(0,0,0))){var d=a.slice();add_pos(d,c);var e=get_world_cell(d);if(e!=undefined_color)return e}b+=1}return-1}function generate_world_cell(a){var b=-1;if(4*Math.random()>1)b=get_random_neighbor_cell(a);else{var c=15,d=get_pos_z(a),e=15;e>d&&(c=100-(100-c)/(e-d)),100*Math.random()>c&&(b=get_random_layer_composition_color_at_pos(a))}set_undefined_world_cell(a,b)}function reset_world_cells(){var a=new_pos(0,0,0),b=new_pos(20,20,20);for(world_cells=[];get_pos_z(a)<get_pos_z(b);){for(set_pos_y(a,0);get_pos_y(a)<get_pos_y(b);){for(set_pos_x(a,0);get_pos_x(a)<get_pos_x(b);)generate_world_cell(a),add_pos(a,new_pos(1,0,0));add_pos(a,new_pos(0,1,0))}add_pos(a,new_pos(0,0,1))}}function get_perpendicular_direction(a){var b=Math.atan2(get_pos_y(a),get_pos_x(a));return b+=Math.PI/2,new_pos(Math.round(Math.cos(b)),Math.round(Math.sin(b)),0)}function rotate_direction(a,b){var c=Math.atan2(get_pos_y(a),get_pos_x(a));c+=b,set_pos_x(a,Math.round(Math.cos(c))),set_pos_y(a,Math.round(Math.sin(c)))}function rotate_pos_by_direction(a,b){var c=get_perpendicular_direction(b),d=new_pos(0,0,get_pos_z(a)),e=b.slice();return multiply_pos(e,get_pos_y(a)),add_pos(d,e),e=c.slice(),multiply_pos(e,get_pos_x(a)),add_pos(d,e),d}function clear_canvas(){canvasContexts.canvas.fillStyle="rgb(255, 255, 255)",canvasContexts.canvas.fillRect(0,0,canvas_width,canvas_height)}function set_cube_pos(a,b){a[1]=b}function get_cube_pos(a){return a[1]}function set_cube_color(a,b){a[2]=b}function get_cube_color(a){return a[2]}function new_cube(a,b){return["cube",a,b]}function add_cube_in_view(a){cubes_in_view[cubes_in_view.length]=a}function set_cubes_in_view(){cubes_in_view=[];for(var a=5,b=new_pos(0,a,0);get_pos_y(b)>-1;){for(set_pos_z(b,-a);get_pos_z(b)<a+1;){for(set_pos_x(b,-a);get_pos_x(b)<a+1;){var c=player_pos.slice();add_pos(c,rotate_pos_by_direction(b,player_direction));var d=get_world_cell(c);if(d==undefined_color&&generate_world_cell(c),-1!=d){var e=new_cube(b.slice(),d);add_cube_in_view(e)}add_pos(b,new_pos(1,0,0))}add_pos(b,new_pos(0,0,1))}add_pos(b,new_pos(0,-1,0))}}function cube_is_farther(a,b){var c=get_cube_pos(a),d=get_cube_pos(b),e=Math.abs(get_pos_x(c))+Math.abs(get_pos_z(c)),f=Math.abs(get_pos_x(d))+Math.abs(get_pos_z(d));return e>f}function sort_cubes_in_view(){for(var a=0;a<cubes_in_view.length;){for(var b=a+1,c=cubes_in_view[a],d=get_pos_y(get_cube_pos(c));b<cubes_in_view.length;){var e=cubes_in_view[b];if(d>get_pos_y(get_cube_pos(e)))break;b+=1}for(;b>a;){var f=a,c=cubes_in_view[f],g=c,h=f;for(f+=1;b>f;){var e=cubes_in_view[f];cube_is_farther(e,g)&&(g=e,h=f),f+=1}cubes_in_view[a]=g,cubes_in_view[h]=c,a+=1}}}function cube_is_on_canvas(a,b){return!(get_point_x(a)+b<0|get_point_x(a)>canvas_width|get_point_y(a)+b<0|get_point_y(a)>canvas_height)}function draw_cubes_in_view(){for(var a=0;a<cubes_in_view.length;){var b=cubes_in_view[a];a+=1;var c=getPrivateVariable(b,"pos"),d=getPrivateVariable(c,"y")+2,e=(getPrivateVariable(c,"x")-.5)/d,f=(getPrivateVariable(c,"z")-.5)/d;e=e*square_size+canvas_width/2,f=f*square_size+canvas_height/2;var g=new_point(e,f),h=square_size/d;d=getPrivateVariable(c,"y")+3,e=(getPrivateVariable(c,"x")-.5)/d,f=(getPrivateVariable(c,"z")-.5)/d,e=e*square_size+canvas_width/2,f=f*square_size+canvas_height/2;var i=new_point(e,f),j=square_size/d;cube_is_on_canvas(i,j)&&(draw_cube_polygons(g,h,i,j,getPrivateVariable(b,"color")),draw_square(g,h,getPrivateVariable(b,"color")))}draw_player()}function draw_world_cells(){set_cubes_in_view(),sort_cubes_in_view(),draw_cubes_in_view()}function display_player_pos(){if(!pos_is_equal(last_player_pos,player_pos)){var a="(";a+=get_pos_x(player_pos),a+=", ",a+=get_pos_y(player_pos),a+=", ",a+=get_pos_z(player_pos),a+=")",document.getElementById("pos.div").innerHTML=a,last_player_pos=player_pos.slice()}}function draw_everything(){clear_canvas(),draw_world_cells(),display_player_pos()}function person_may_occupy_pos(a){var b=a.slice();return add_pos(b,new_pos(0,0,1)),-1==get_world_cell(a)&&-1==get_world_cell(b)}function process_world_cells(){var a=player_pos.slice();add_pos(a,new_pos(0,0,1)),person_may_occupy_pos(a)&&add_pos(player_pos,new_pos(0,0,1)),draw_everything()}function move_player(a){var b=player_pos.slice();return add_pos(b,rotate_pos_by_direction(a,player_direction)),person_may_occupy_pos(b)||add_pos(b,new_pos(0,0,-1)),person_may_occupy_pos(b)?void(player_pos=b):!1}function rotate_player(a){rotate_direction(player_direction,a)}function build_cell_near_player(a){var b=player_pos.slice();add_pos(b,rotate_pos_by_direction(a,player_direction));var c=get_world_cell(b),d=selected_inventory_item_color;if(-1!=c&&(offset_inventory_item_by_color(c,1),d=-1),-1!=d){var e=offset_inventory_item_by_color(d,-1);if(!e)return!1}set_world_cell(b,d)}function key_down(){var a=cypherEvent.which;return 91==a&&(key_is_held.command=!0),key_is_held.command?0:(65==a&&rotate_player(-(Math.PI/2)),68==a&&rotate_player(Math.PI/2),87==a&&move_player(new_pos(0,1,0)),83==a&&move_player(new_pos(0,-1,0)),90==a&&move_player(new_pos(-1,0,0)),67==a&&move_player(new_pos(1,0,0)),84==a&&build_cell_near_player(new_pos(0,1,-1)),82==a&&build_cell_near_player(new_pos(0,1,0)),70==a&&build_cell_near_player(new_pos(0,1,1)),void(86==a&&build_cell_near_player(new_pos(0,1,2))))}function key_up(){var a=cypherEvent.which;91==a&&(key_is_held.command=!1)}function compress_code(a){for(var b="",c=0,d=1;c<a.length;){var e=1,f=a.substring(c,d),g=f;for(c+=1,d+=1;c<a.length&&a.substring(c,d)==f&&e<color_character_set.length-1;)e+=1,c+=1,d+=1,g+=f;e>3&&(g="<",g+=color_character_set.substring(e,e+1),g+=f),b+=g}return b}function decompress_code(a){for(var b="",c=0;c<a.length;){var d=a.indexOf("<",c);if(-1==d&&(d=a.length),b+=a.substring(c,d),d>a.length-1)break;var e=a.substring(d+1,d+2),f=color_character_set.indexOf(e);for(e=a.substring(d+2,d+3);f>0;)b+=e,f-=1;c=d+3}return b}function get_code_from_world_cells(){for(var a="",b=getArrayKeys(world_cells),c=0;c<b.length;){var d=b[c];c+=1,a+="(z"+d+")";for(var e=world_cells[d],f=getArrayKeys(e),g=0;g<f.length;){var h=f[g];g+=1,a+="(y"+h+")";for(var i=e[h],j=getArrayKeys(i),k="bupkis",l=0;l<j.length;){var m=j[l];l+=1,m!=k+1&&(a+="(x"+m+")"),k=parseInt(m);var n=i[m],o=color_character_set.substring(n+1,n+2);a+=o}}}return a}function get_code_from_player_pos_and_direction(){var a="(x)";return a+=get_pos_x(player_pos),a+="(y)",a+=get_pos_y(player_pos),a+="(z)",a+=get_pos_z(player_pos),a+="(dx)",a+=get_pos_x(player_direction),a+="(dy)",a+=get_pos_y(player_direction)}function get_code_from_layer_compositions(){for(var a="",b=0;b<layer_compositions.length;){var c=layer_compositions[b];b+=1,a+="(z)",a+=get_layer_composition_pos_z(c),a+="(s)",a+=get_layer_composition_size(c);for(var d=get_layer_composition_colors(c),e=0;e<d.length;){var f=d[e];e+=1,a+="(c)",a+=f[0],a+="(p)",a+=f[1]}}return a}function get_code_from_inventory_items(){for(var a="",b=0;b<inventory_items.length;){var c=inventory_items[b];b+=1,a+="(c)",a+=get_inventory_item_color(c),a+="(a)",a+=get_inventory_item_amount(c)}return a}function get_code_from_world(){var a="[w]";return a+=get_code_from_world_cells(),a+="[p]",a+=get_code_from_player_pos_and_direction(),a+="[l]",a+=get_code_from_layer_compositions(),a+="[i]",a+=get_code_from_inventory_items(),compress_code(a)}function set_world_cells_from_code(a){a=decompress_code(a),world_cells=[];for(var b=new_pos(0,0,0),c=0;c<a.length;){var d=a.substring(c,c+1);if("("==d){c+=1;var e=a.substring(c,c+1);c+=1;var f=a.indexOf(")",c),g=parseInt(a.substring(c,f));"x"==e&&set_pos_x(b,g),"y"==e&&set_pos_y(b,g),"z"==e&&set_pos_z(b,g),c=f+1}else{var h=color_character_set.indexOf(d)-1;set_undefined_world_cell(b,h),add_pos(b,new_pos(1,0,0)),c+=1}}}function set_player_position_and_direction_from_code(a){var b=a.indexOf("(x)")+3,c=a.indexOf("(y)",b);set_pos_x(player_pos,parseInt(a.substring(b,c))),b=c+3,c=a.indexOf("(z)",b),set_pos_y(player_pos,parseInt(a.substring(b,c))),b=c+3,c=a.indexOf("(dx)",b),set_pos_z(player_pos,parseInt(a.substring(b,c))),b=c+4,c=a.indexOf("(dy)",b),set_pos_x(player_direction,parseInt(a.substring(b,c))),b=c+4,c=a.length,set_pos_y(player_direction,parseInt(a.substring(b,c)))}function set_layer_compositions_from_code(a){layer_compositions=[];for(var b=0;b<a.length;){var c=b+3;b=a.indexOf("(s)",c);var d=parseInt(a.substring(c,b));c=b+3,b=a.indexOf("(c)",c);for(var e=parseInt(a.substring(c,b)),f=[];"(z)"!=a.substring(b,b+3)&&b<a.length;){var g=[];c=b+3,b=a.indexOf("(p)",c),g[g.length]=parseInt(a.substring(c,b)),c=b+3,b=a.indexOf("(",c),-1==b&&(b=a.length),g[g.length]=parseInt(a.substring(c,b)),f[f.length]=g}var h=new_layer_composition(d,e,f);layer_compositions[layer_compositions.length]=h}}function set_inventory_items_from_code(a){inventory_items=[];for(var b=0;b<a.length;){var c=b+3;b=a.indexOf("(a)",c);var d=parseInt(a.substring(c,b));c=b+3,b=a.indexOf("(c)",c),-1==b&&(b=a.length);var e=parseInt(a.substring(c,b)),f=new_inventory_item(d,e);inventory_items[inventory_items.length]=f}selected_inventory_item_color=-1,display_inventory_items()}function set_world_from_code(a){var b=a.indexOf("[w]")+3,c=a.indexOf("[p]",b);set_world_cells_from_code(a.substring(b,c)),b=c+3,c=a.indexOf("[l]",b),set_player_position_and_direction_from_code(a.substring(b,c)),b=c+3,c=a.indexOf("[i]",b),set_layer_compositions_from_code(a.substring(b,c)),b=c+3,c=a.length,set_inventory_items_from_code(a.substring(b,c))}function display_world_code(){var a=get_code_from_world();setTagAttribute("world.code","value",a)}function set_world_from_textbox(){var a=getTagAttribute("world.code","value");set_world_from_code(a)}cypherEvent=0,nextTagId=0,tagIdStack=["body"],tagIdStackIndex=0,canvasContexts=[],classParents=[];var canvas_width=250,canvas_height=250,square_size=canvas_height/2,undefined_color=21,color_character_set=".0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&@";document.getElementById("body").style.background="#444444",addTag("body.div","div","body"),document.getElementById("body.div").style.width="700px",document.getElementById("body.div").style.background="white",document.getElementById("body.div").style.padding="20px",document.getElementById("body.div").style["margin-left"]="auto",document.getElementById("body.div").style["margin-right"]="auto",addTag("left.div","div","body.div"),document.getElementById("left.div").style["float"]="left",addTag("canvas","canvas","left.div"),setTagAttribute("canvas","width",canvas_width),setTagAttribute("canvas","height",canvas_height),document.getElementById("canvas").style.border="3px black solid",addTag("right.div","div","body.div"),document.getElementById("right.div").style["float"]="left",document.getElementById("right.div").style["margin-left"]="3px",document.getElementById("right.div").style.border="3px black solid",document.getElementById("right.div").style.padding="10px",addTag("get.code.button","button","right.div"),document.getElementById("get.code.button").innerHTML="Get code",document.getElementById("get.code.button").setAttribute("onclick","cypherEvent = event; display_world_code()"),addTag("set.code.button","button","right.div"),document.getElementById("set.code.button").innerHTML="Set code",document.getElementById("set.code.button").setAttribute("onclick","cypherEvent = event; set_world_from_textbox()"),addTag("a","br","right.div"),addTag("world.code","textarea","right.div"),setTagAttribute("world.code","rows",1),setTagAttribute("world.code","cols",13),addTag("a","br","right.div"),addTag("inventory.title","strong","right.div"),document.getElementById("inventory.title").innerHTML="Inventory  ",addTag("inventory.scroll.left","button","right.div"),document.getElementById("inventory.scroll.left").innerHTML="<",document.getElementById("inventory.scroll.left").setAttribute("onclick","cypherEvent = event; scroll_inventory_list('-6')"),addTag("inventory.scroll.right","button","right.div"),document.getElementById("inventory.scroll.right").innerHTML=">",document.getElementById("inventory.scroll.right").setAttribute("onclick","cypherEvent = event; scroll_inventory_list('6')");for(var inventory_div_amount=6,inventory_div_count=0;inventory_div_amount>inventory_div_count;){var inventory_br_name="inventory.br."+inventory_div_count;addTag(inventory_br_name,"br","right.div"),document.getElementById(inventory_br_name).style.clear="both";var inventory_square_name="inventory.square."+inventory_div_count;addTag(inventory_square_name,"div","right.div"),document.getElementById(inventory_square_name).style["float"]="left",document.getElementById(inventory_square_name).style.width="15px",document.getElementById(inventory_square_name).style.height="15px",document.getElementById(inventory_square_name).style.background="white",document.getElementById(inventory_square_name).style.margin="4px",document.getElementById(inventory_square_name).innerHTML=" ";var inventory_div_name="inventory.div."+inventory_div_count;addTag(inventory_div_name,"div","right.div"),document.getElementById(inventory_div_name).style.border="3px white solid",document.getElementById(inventory_div_name).style["float"]="left",document.getElementById(inventory_div_name).innerHTML=" ",document.getElementById(inventory_div_name).setAttribute("onclick","cypherEvent = event; select_inventory_item('"+inventory_div_count+"')"),inventory_div_count+=1}addTag("pos.div","div","body.div"),document.getElementById("pos.div").style["float"]="left",document.getElementById("pos.div").style["margin-left"]="10px",document.getElementById("pos.div").innerHTML="(0, 0, 0)",addTag("br.one","br","body.div"),document.getElementById("br.one").style.clear="both",addTag("instructions","p","body.div"),document.getElementById("instructions").innerHTML="Use WASDZC to move. Use VFRT to collect blocks and build. To save your work, retrieve a save code and paste it back later.",addTag("end.div","div","body"),document.getElementById("end.div").style.width="700px",document.getElementById("end.div").style["margin-bottom"]="50px",document.getElementById("end.div").style["margin-left"]="auto",document.getElementById("end.div").style["margin-right"]="auto",addTag("return.to.pond.div","div","end.div"),document.getElementById("return.to.pond.div").style.background="white",document.getElementById("return.to.pond.div").style["text-align"]="center",document.getElementById("return.to.pond.div").style.width="200px",document.getElementById("return.to.pond.div").style["margin-left"]="auto",document.getElementById("return.to.pond.div").style["padding-left"]="20px",document.getElementById("return.to.pond.div").style["padding-right"]="20px",document.getElementById("return.to.pond.div").style["padding-bottom"]="20px",document.getElementById("return.to.pond.div").style["padding-top"]="10px",addTag("return.to.pond.link","a","return.to.pond.div"),setTagAttribute("return.to.pond.link","href","http://www.ostracodfiles.com/ostracod/main.html"),document.getElementById("return.to.pond.link").innerHTML="Return to the Ostracod Pond",document.getElementById("return.to.pond.link").style.color="black",addTag("return.to.pond.div2","div","end.div"),document.getElementById("return.to.pond.div2").style.background="white",document.getElementById("return.to.pond.div2").style["text-align"]="center",document.getElementById("return.to.pond.div2").style.width="200px",document.getElementById("return.to.pond.div2").style["margin-left"]="auto",document.getElementById("return.to.pond.div2").style["padding-left"]="20px",document.getElementById("return.to.pond.div2").style["padding-right"]="20px",document.getElementById("return.to.pond.div2").style["padding-bottom"]="20px",document.getElementById("return.to.pond.div2").style["padding-top"]="10px",document.getElementById("return.to.pond.div2").innerHTML='<a href="https://git123hub.github.io/index/">\u8fd4\u56de\u5230\u9996\u9875</a>';var inventory_items=[],selected_inventory_item_color=-1,inventory_list_position=0,layer_compositions=[],world_cells=[];reset_world_cells();var player_pos=new_pos(10,10,10),last_player_pos=new_pos(0,0,0),player_direction=new_pos(0,1,0),cubes_in_view=[],key_is_held=[];key_is_held.command=!1,document.getElementById("body").setAttribute("onkeydown","cypherEvent = event; key_down()"),document.getElementById("body").setAttribute("onkeyup","cypherEvent = event; key_up()"),setInterval("process_world_cells()",200),draw_everything();